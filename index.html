<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>PBI™ Ultimate Tools 2026 - FF UID Info, Ban Check & Item Library by Gopal Patel</title>
    <meta name="description" content="Official PBI™ Tools 2026 by Gopal Patel. Check Free Fire Account Info (UID), Created Date, Last Login, Ban Status, Guild Details and massive Item Library. Fast & Secure.">
    <meta name="keywords" content="Gopal Patel, PBI Tools, Patel Digital Gamer, Free Fire UID Check, FF Account Info, FF Ban Check, Free Fire Item Library, FF Guild Info, Free Fire Tools 2026, PBI Digital, FF Config Download">
    <meta name="author" content="Gopal Patel (PBI™)">
    <meta name="robots" content="index, follow">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;500;700;900&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg: #050505;
            --card-bg: #0f0f13;
            --border: #2a2a2a;
            --primary: #3b82f6; 
            --accent: #8b5cf6; 
            --text: #ffffff;
            --text-gray: #a1a1aa;
            --radius: 16px;
            --grad: linear-gradient(135deg, var(--primary), var(--accent));
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Outfit', sans-serif; }
        
        body { 
            background: var(--bg); color: var(--text); min-height: 100vh; padding-bottom: 60px;
        }

        /* HEADER */
        header {
            background: rgba(5, 5, 5, 0.9); backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border); padding: 15px 20px;
            position: sticky; top: 0; z-index: 100;
            display: flex; justify-content: space-between; align-items: center;
        }
        .brand { display: flex; align-items: center; gap: 12px; }
        .brand img { width: 45px; height: 45px; border-radius: 50%; border: 2px solid var(--primary); }
        .brand h1 { font-size: 1.4rem; font-weight: 800; letter-spacing: 0.5px; }
        .brand span { color: var(--primary); }

        .admin-btn {
            background: #1a1a1a; border: 1px solid var(--border);
            padding: 8px 15px; border-radius: 8px; font-size: 0.85rem; cursor: pointer; transition: 0.3s;
        }
        .admin-btn:hover { border-color: var(--primary); color: var(--primary); }

        /* CONTAINER */
        .container { max-width: 1000px; margin: 30px auto; padding: 0 15px; }
        #maint-screen { display: none; text-align: center; padding: 80px 20px; }
        #maint-screen i { font-size: 4rem; color: #fbbf24; margin-bottom: 20px; }

        /* GRID SYSTEM */
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 15px; }
        .card {
            background: var(--card-bg); border: 1px solid var(--border);
            padding: 25px 15px; border-radius: var(--radius); text-align: center;
            cursor: pointer; transition: 0.3s; position: relative;
        }
        .card:hover { transform: translateY(-5px); border-color: var(--primary); background: #14141a; }
        .card i { 
            font-size: 2.2rem; margin-bottom: 12px; 
            background: var(--grad); -webkit-background-clip: text; -webkit-text-fill-color: transparent; 
        }
        .card h3 { font-size: 0.9rem; font-weight: 700; text-transform: uppercase; }
        .badge { position: absolute; top: 10px; right: 10px; background: #ef4444; font-size: 0.6rem; padding: 2px 6px; border-radius: 4px; font-weight: bold; }

        /* SECTIONS & INPUTS */
        .section { display: none; animation: fadeUp 0.4s ease; }
        .active { display: block; }
        
        .back-btn {
            background: #1a1a1a; border: 1px solid var(--border); color: #ccc;
            padding: 10px 20px; border-radius: 20px; cursor: pointer; display: inline-flex;
            align-items: center; gap: 8px; margin-bottom: 20px; font-size: 0.9rem;
        }

        .input-area {
            background: var(--card-bg); padding: 25px; border-radius: var(--radius);
            border: 1px solid var(--border); max-width: 500px; margin: 0 auto;
        }
        .input-area h2 { text-align: center; margin-bottom: 20px; color: var(--primary); font-weight: 800; }

        input, select, textarea {
            width: 100%; background: #050505; border: 1px solid var(--border);
            padding: 14px; color: #fff; border-radius: 8px; margin-bottom: 12px;
            outline: none; font-size: 1rem;
        }
        input:focus, select:focus, textarea:focus { border-color: var(--primary); }

        .btn-main {
            width: 100%; padding: 15px; background: var(--grad); border: none;
            border-radius: 8px; color: #fff; font-weight: 800; cursor: pointer;
            text-transform: uppercase; letter-spacing: 1px;
        }
        .btn-main:hover { opacity: 0.9; }

        /* CATEGORY TABS */
        .cat-scroll {
            display: flex; gap: 10px; overflow-x: auto; padding-bottom: 10px; margin-bottom: 15px;
        }
        .cat-btn {
            background: #1a1a1a; border: 1px solid var(--border); color: #aaa;
            padding: 8px 16px; border-radius: 20px; white-space: nowrap; cursor: pointer;
            font-size: 0.85rem; transition: 0.2s;
        }
        .cat-btn.active-cat { background: var(--primary); color: #fff; border-color: var(--primary); }

        /* LIBRARY GRID */
        .lib-grid { 
            display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-top: 15px; 
        }
        @media (min-width: 768px) { .lib-grid { grid-template-columns: repeat(4, 1fr); } }

        .lib-item { 
            background: #000; padding: 15px; border-radius: 12px; 
            border: 1px solid var(--border); text-align: center; position: relative;
        }
        .lib-item:hover { border-color: var(--accent); transform: scale(1.02); }
        .lib-item img { width: 100%; height: 80px; object-fit: contain; margin-bottom: 10px; }
        .lib-name { font-size: 0.85rem; font-weight: 600; color: #fff; margin-bottom: 5px; }
        .lib-id { font-size: 0.7rem; color: #666; background: #111; padding: 2px 6px; border-radius: 4px; }
        .lib-cat-tag { font-size: 0.6rem; color: var(--primary); position: absolute; top:5px; right:5px; }

        /* FILE LIST ITEM */
        .file-item {
            background:#0f0f13; padding:15px; border-radius:12px; border:1px solid #222; 
            margin-bottom:10px; display:flex; justify-content:space-between; align-items:center;
        }

        /* MODALS */
        .modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); z-index: 200; align-items: center; justify-content: center;
        }
        .modal-box {
            background: #111; padding: 30px; border-radius: var(--radius);
            width: 95%; max-width: 600px; border: 1px solid var(--border);
            max-height: 90vh; overflow-y: auto; animation: fadeUp 0.3s;
        }
        .admin-section { border-bottom: 1px solid #333; padding-bottom: 15px; margin-bottom: 20px; }
        .admin-section h3 { color: var(--primary); font-size: 1rem; margin-bottom: 10px; }
        
        .admin-row { display: flex; gap: 10px; margin-bottom: 10px; }
        .admin-row input { margin-bottom: 0; }

        @keyframes fadeUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        /* RESULT BOX (DETAILED) */
        .result-box {
            background: var(--card-bg); border: 1px solid var(--border);
            border-radius: var(--radius); padding: 20px; margin-top: 20px; display: none;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .ac-header {
            text-align: center; border-bottom: 1px solid var(--border); padding-bottom: 20px; margin-bottom: 15px;
        }
        .ac-avatar {
            width: 100px; height: 100px; margin: 0 auto 15px;
            border-radius: 50%; border: 3px solid var(--primary); padding: 3px;
        }
        .ac-avatar img { width: 100%; height: 100%; object-fit: cover; border-radius: 50%; }
        
        .ac-name { font-size: 1.8rem; font-weight: 800; margin-bottom: 5px; color: #fff; }
        .ac-uid { 
            background: #1a1a1a; padding: 4px 15px; border-radius: 20px; 
            font-size: 0.9rem; color: var(--text-gray); display: inline-block;
        }

        .info-row {
            display: flex; justify-content: space-between; align-items: center;
            padding: 12px 0; border-bottom: 1px solid #1f1f1f;
        }
        .info-row:last-child { border: none; }
        
        .lbl { display: flex; align-items: center; gap: 10px; color: var(--text-gray); font-size: 0.95rem; }
        .lbl i { color: var(--primary); width: 20px; text-align: center; }
        .val { font-weight: 700; font-size: 1rem; color: #fff; text-align: right; }
    </style>
</head>
<body>

<header>
    <div class="brand">
        <a href="#"><img src="https://i.ibb.co/LDdWvds1/1767423889312.png" alt="PBI Logo"></a>
        <div>
            <h1>PBI™ <span>TOOLS</span></h1>
            <p style="font-size:0.7rem; color:#888;">Ultimate 2026 Edition</p>
        </div>
    </div>
    <div class="admin-btn" onclick="openLogin()">ADMIN <i class="fas fa-user-shield"></i></div>
</header>

<div class="container">

    <div id="maint-screen">
        <i class="fas fa-tools"></i>
        <h1>Maintenance Mode</h1>
        <p>System update in progress. Please wait.</p>
    </div>

    <div id="home" class="section active">
        <div class="grid">
            <div class="card" onclick="goTo('page-ac')">
                <i class="fas fa-id-card-clip"></i>
                <h3>FF AC INFO</h3>
            </div>
            <div class="card" onclick="goTo('page-items')">
                <i class="fas fa-layer-group"></i>
                <h3>ITEM LIBRARY</h3>
            </div>
            <div class="card" onclick="goTo('page-files')">
                <i class="fas fa-lock"></i>
                <h3>FILES ADDA</h3>
            </div>
            <div class="card" onclick="goTo('page-guild')">
                <i class="fas fa-users-gear"></i>
                <h3>GUILD INFO</h3>
            </div>
            <div class="card" onclick="goTo('page-region')">
                <i class="fas fa-earth-americas"></i>
                <h3>REGION CHECK</h3>
            </div>
            <div class="card" onclick="goTo('page-ban')">
                <i class="fas fa-gavel"></i>
                <h3>BAN CHECK</h3>
            </div>
            <div class="card" onclick="goTo('page-wish')">
                <div id="badge-wish"></div>
                <i class="fas fa-wand-magic-sparkles"></i>
                <h3>WISHLIST</h3>
            </div>
        </div>
        
        <div style="margin-top: 40px; padding: 25px; background: #0f0f13; border: 1px solid #222; border-radius: 12px;">
            <h2 style="color:var(--primary); font-size:1.2rem; margin-bottom:10px;">About PBI™ Digital Gamer Tools</h2>
            <p style="color:#888; line-height:1.6; font-size:0.9rem;">
                Official PBI™ Tools 2026 by <strong>Gopal Patel</strong>. Get instant details for Free Fire accounts including Created Date, Last Login, Guild Info and explore the massive Item Library.
            </p>
        </div>
    </div>

    <div id="page-ac" class="section">
        <div class="back-btn" onclick="goTo('home')"><i class="fas fa-arrow-left"></i> Main Menu</div>
        <div class="input-area">
            <h2><i class="fas fa-user-check"></i> Account Info</h2>
            <input type="number" id="ac-uid" placeholder="Enter UID (e.g. 3006565836)">
            <select id="ac-region">
                <option value="IND">India</option>
                <option value="BD">Bangladesh</option>
                <option value="SG">Singapore</option>
                <option value="BR">Brazil</option>
                <option value="EU">Europe</option>
            </select>
            <button class="btn-main" onclick="fetchAcInfo()">GET DATA</button>
        </div>
        <div id="res-ac" class="result-box"></div>
    </div>

    <div id="page-items" class="section">
        <div class="back-btn" onclick="goTo('home')"><i class="fas fa-arrow-left"></i> Main Menu</div>
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
            <h2><i class="fas fa-box-open"></i> Item Library</h2>
            <span style="font-size:0.8rem; color:#666;">Total: <span id="item-count">0</span></span>
        </div>
        <div class="cat-scroll" id="cat-tabs"></div>
        <div id="lib-container" class="lib-grid"></div>
    </div>

    <div id="page-files" class="section">
        <div class="back-btn" onclick="goTo('home')"><i class="fas fa-arrow-left"></i> Main Menu</div>
        <div id="files-lock" class="input-area" style="text-align:center">
            <i class="fas fa-shield-halved" style="font-size:3rem; color:var(--accent); margin-bottom:15px;"></i>
            <h3>Restricted Area</h3>
            <p style="color:#666; font-size:0.9rem; margin-bottom:15px;">Enter Access Code to view PBI Files.</p>
            <input type="password" id="file-pass-input" placeholder="Enter Password">
            <button class="btn-main" onclick="unlockFiles()">UNLOCK FILES</button>
        </div>
        <div id="files-open" style="display:none">
            <h2 style="margin-bottom:20px; text-align:center;">PBI™ Private Files</h2>
            <div id="files-list-container"></div>
        </div>
    </div>

    <div id="page-guild" class="section">
        <div class="back-btn" onclick="goTo('home')"><i class="fas fa-arrow-left"></i> Main Menu</div>
        <div class="input-area">
            <h2>Guild Check</h2>
            <input type="number" id="gd-uid" placeholder="Player UID">
            <select id="gd-region"><option value="IND">India</option><option value="BD">BD</option></select>
            <button class="btn-main" onclick="fetchGuildInfo()">CHECK GUILD</button>
        </div>
        <div id="res-gd" class="result-box"></div>
    </div>

    <div id="page-region" class="section">
        <div class="back-btn" onclick="goTo('home')"><i class="fas fa-arrow-left"></i> Main Menu</div>
        <div class="input-area">
            <h2>Region Finder</h2>
            <input type="number" id="reg-uid" placeholder="Player UID">
            <button class="btn-main" onclick="fetchRegion()">FIND REGION</button>
        </div>
        <div id="res-reg" class="result-box" style="text-align:center;">
            <h1 id="reg-txt" style="font-size:3rem; color:var(--primary); margin:10px 0;">--</h1>
            <p style="color:#888;">Server Location</p>
        </div>
    </div>

    <div id="page-ban" class="section">
        <div class="back-btn" onclick="goTo('home')"><i class="fas fa-arrow-left"></i> Main Menu</div>
        <div class="input-area">
            <h2>Ban Status Check</h2>
            <input type="number" id="ban-uid" placeholder="Player UID">
            <button class="btn-main" onclick="fetchBan()">CHECK BAN</button>
        </div>
        <div id="res-ban" class="result-box"></div>
    </div>

    <div id="page-wish" class="section">
        <div class="back-btn" onclick="goTo('home')"><i class="fas fa-arrow-left"></i> Main Menu</div>
        <div id="wish-content" style="text-align:center; padding:50px;"></div>
    </div>

</div>

<div id="modal-login" class="modal">
    <div class="modal-box" style="text-align:center;">
        <h2 style="margin-bottom:20px;">Admin Access</h2>
        <input type="password" id="adm-p" placeholder="Enter Admin Password">
        <button class="btn-main" onclick="doLogin()">LOGIN</button>
        <button onclick="document.getElementById('modal-login').style.display='none'" style="margin-top:15px; background:transparent; border:none; color:#666; cursor:pointer;">Cancel</button>
    </div>
</div>

<div id="modal-admin" class="modal">
    <div class="modal-box">
        <div style="display:flex; justify-content:space-between; margin-bottom:20px;">
            <h2>PBI™ Admin Panel</h2>
            <button onclick="document.getElementById('modal-admin').style.display='none'" style="background:transparent; border:none; color:#fff; font-size:1.5rem;">&times;</button>
        </div>

        <div class="admin-section">
            <h3>System Control</h3>
            <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
                <span>Maintenance Mode</span>
                <button id="btn-maint" onclick="toggleSet('maint')" style="padding:5px 15px; background:#333; color:#fff; border:none; border-radius:5px;">OFF</button>
            </div>
            <div style="display:flex; justify-content:space-between;">
                <span>Wishlist Status</span>
                <button id="btn-soon" onclick="toggleSet('soon')" style="padding:5px 15px; background:#333; color:#fff; border:none; border-radius:5px;">ON</button>
            </div>
        </div>

        <div class="admin-section">
            <h3>Files Adda Manager</h3>
            <label style="font-size:0.8rem; color:#888;">Change Unlock Password:</label>
            <div class="admin-row">
                <input type="text" id="admin-file-pass" placeholder="New Password">
                <button onclick="saveFilePass()" style="background:var(--primary); border:none; color:#fff; padding:0 15px; border-radius:6px;">Save</button>
            </div>
            <label style="font-size:0.8rem; color:#888; margin-top:10px; display:block;">Add New File:</label>
            <div class="admin-row">
                <input type="text" id="new-file-name" placeholder="Name">
                <input type="text" id="new-file-size" placeholder="Size" style="width:80px;">
            </div>
            <input type="text" id="new-file-link" placeholder="Download Link URL">
            <button class="btn-main" onclick="adminAddFile()" style="font-size:0.8rem; padding:10px;">ADD FILE</button>
            <div style="margin-top:15px;">
                <h4 style="font-size:0.9rem; color:#888; margin-bottom:5px;">Manage Existing Files:</h4>
                <div id="admin-files-list"></div>
            </div>
        </div>

        <div class="admin-section">
            <h3>Category Manager</h3>
            <div class="admin-row">
                <input type="text" id="new-cat-name" placeholder="New Category Name">
                <button onclick="addCategory()" style="background:var(--primary); border:none; color:#fff; padding:0 15px; border-radius:6px;">Add</button>
            </div>
            <div id="admin-cat-list" style="display:flex; flex-wrap:wrap; gap:5px; margin-top:10px;"></div>
        </div>

        <div class="admin-section">
            <h3>Bulk Item Import (Auto Image)</h3>
            <p style="font-size:0.8rem; color:#888; margin-bottom:10px;">Upload a .txt/.json or paste IDs. Duplicates skipped.</p>
            <select id="import-cat" style="margin-bottom:10px;"></select>
            <input type="file" id="import-file" accept=".txt,.json" style="padding:10px; background:#1a1a1a;">
            <textarea id="import-text" rows="3" placeholder="Or paste IDs here: 909040012, 909045010..."></textarea>
            <button class="btn-main" onclick="importBulkItems()" style="font-size:0.8rem; padding:10px;">IMPORT & AUTO ADD</button>
        </div>

        <div class="admin-section" style="border:none;">
            <h3>API Keys</h3>
            <input type="text" id="key-info" placeholder="Info API Key">
            <input type="text" id="key-ban" placeholder="Ban API Key">
            <button class="btn-main" onclick="saveKeys()">UPDATE KEYS</button>
        </div>
    </div>
</div>

<script>
    // --- CONFIGURATION ---
    const BASE_URL = "https://info-self-ten.vercel.app/info"; 
    const DB_KEY = 'PBI_2026_V3_FINAL';

    // Legacy Defaults
    const DEFAULT_ITEMS = [
      { "name": "6th Anniversary", "id": "909040012" }, { "name": "Flower Salute", "id": "909045010" },
      { "name": "MP40 Evo", "id": "909000075" }, { "name": "Scar Evo", "id": "909000068" }
    ];

    const DEFAULT_FILES = [
        { name: "PBI Config V2.zip", size: "4.5MB", link: "#", id: 1 },
        { name: "Rare Assets 2026.txt", size: "12KB", link: "#", id: 2 }
    ];

    let db = JSON.parse(localStorage.getItem(DB_KEY)) || {
        maint: false, soon: true,
        keys: { info: '', ban: '', wish: '' },
        filePass: '67890',
        categories: ["All", "Emotes", "Guns", "Bundles", "Rare"],
        filesList: DEFAULT_FILES,
        extraItems: []
    };

    function saveDB() {
        localStorage.setItem(DB_KEY, JSON.stringify(db));
        renderSettings();
    }

    window.onload = function() {
        renderSettings();
        loadLibrary('All');
        renderCategories();
        renderFiles();
    };

    function goTo(id) {
        if(db.maint && id !== 'home') { alert("⚠️ Site is in Maintenance Mode"); return; }
        document.querySelectorAll('.section').forEach(el => el.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        if(id === 'page-wish') {
            const wc = document.getElementById('wish-content');
            wc.innerHTML = db.soon 
                ? `<i class="fas fa-clock" style="font-size:4rem; color:#333; margin-bottom:20px;"></i><h1 style="color:#666">Coming Soon</h1>` 
                : `<div class="input-area"><h2>Wishlist Check</h2><input type="number" id="wish-uid" placeholder="UID"><button class="btn-main" onclick="fetchWish()">CHECK</button></div><div id="res-wish" class="result-box"></div>`;
        }
    }

    // --- ITEM LIBRARY ---
    function renderCategories() {
        const tabs = document.getElementById('cat-tabs');
        const select = document.getElementById('import-cat');
        const adminList = document.getElementById('admin-cat-list');
        tabs.innerHTML = ''; select.innerHTML = ''; adminList.innerHTML = '';

        db.categories.forEach(cat => {
            tabs.innerHTML += `<button class="cat-btn" onclick="loadLibrary('${cat}', this)">${cat}</button>`;
            if(cat !== 'All') {
                select.innerHTML += `<option value="${cat}">${cat}</option>`;
                adminList.innerHTML += `<div style="background:#333; padding:5px 10px; border-radius:5px; font-size:0.8rem; display:flex; align-items:center; gap:8px;">${cat} <i class="fas fa-times" style="cursor:pointer; color:#ef4444;" onclick="deleteCategory('${cat}')"></i></div>`;
            }
        });
        if(tabs.children.length > 0) tabs.children[0].classList.add('active-cat');
    }

    function loadLibrary(filter, btn) {
        if(btn) { document.querySelectorAll('.cat-btn').forEach(b => b.classList.remove('active-cat')); btn.classList.add('active-cat'); }
        const container = document.getElementById('lib-container');
        container.innerHTML = '';
        let allItems = DEFAULT_ITEMS.map(i => ({...i, category: 'All'}));
        allItems = [...allItems, ...db.extraItems];
        const displayItems = filter === 'All' ? allItems : allItems.filter(i => i.category === filter);
        document.getElementById('item-count').innerText = displayItems.length;

        displayItems.forEach(item => {
            const imgUrl = `https://iconapi.wasmer.app/${item.id}`;
            const catLabel = item.category && item.category !== 'All' ? item.category : '';
            container.innerHTML += `
                <div class="lib-item">
                    ${catLabel ? `<span class="lib-cat-tag">${catLabel}</span>` : ''}
                    <img src="${imgUrl}" loading="lazy" onerror="this.src='https://i.ibb.co/LDdWvds1/1767423889312.png'">
                    <div class="lib-name">${item.name || 'Item ' + item.id}</div>
                    <div class="lib-id">ID: ${item.id}</div>
                </div>`;
        });
    }

    // --- FILES ADDA ---
    function unlockFiles() {
        if(document.getElementById('file-pass-input').value === db.filePass) {
            document.getElementById('files-lock').style.display = 'none';
            document.getElementById('files-open').style.display = 'block';
            renderUserFiles();
        } else alert("Incorrect Password!");
    }

    function renderUserFiles() {
        const c = document.getElementById('files-list-container');
        c.innerHTML = '';
        db.filesList.forEach(f => {
            c.innerHTML += `<div class="file-item"><div><div style="font-weight:700; color:#fff;">${f.name}</div><div style="font-size:0.8rem; color:#666;">Size: ${f.size}</div></div><a href="${f.link}" target="_blank" style="background:#10b981; color:#000; font-weight:bold; text-decoration:none; padding:8px 15px; border-radius:6px;">Download</a></div>`;
        });
    }

    // --- ADMIN ---
    function openLogin() { document.getElementById('modal-login').style.display = 'flex'; }
    function doLogin() {
        if(document.getElementById('adm-p').value === 'GPATEL7') {
            document.getElementById('modal-login').style.display = 'none';
            document.getElementById('modal-admin').style.display = 'flex';
            document.getElementById('admin-file-pass').value = db.filePass;
        } else alert("Wrong Password");
    }

    function addCategory() {
        const name = document.getElementById('new-cat-name').value.trim();
        if(name && !db.categories.includes(name)) { db.categories.push(name); saveDB(); renderCategories(); }
    }
    function deleteCategory(name) {
        if(confirm(`Delete '${name}'?`)) { db.categories = db.categories.filter(c => c !== name); saveDB(); renderCategories(); }
    }

    function saveFilePass() { db.filePass = document.getElementById('admin-file-pass').value; saveDB(); alert("Password Updated"); }
    function adminAddFile() {
        const name = document.getElementById('new-file-name').value;
        const size = document.getElementById('new-file-size').value;
        const link = document.getElementById('new-file-link').value;
        if(name && link) { db.filesList.push({name, size, link, id: Date.now()}); saveDB(); renderFiles(); alert("File Added"); }
    }
    function adminDeleteFile(id) { if(confirm("Delete file?")) { db.filesList = db.filesList.filter(f => f.id !== id); saveDB(); renderFiles(); } }
    function renderFiles() {
        const list = document.getElementById('admin-files-list'); list.innerHTML = '';
        db.filesList.forEach(f => { list.innerHTML += `<div style="display:flex; justify-content:space-between; background:#222; padding:8px; margin-bottom:5px; border-radius:5px;"><span style="font-size:0.85rem;">${f.name}</span><button onclick="adminDeleteFile(${f.id})" style="color:#ef4444; background:none; border:none; cursor:pointer;">Delete</button></div>`; });
    }

    async function importBulkItems() {
        const cat = document.getElementById('import-cat').value;
        const textVal = document.getElementById('import-text').value;
        const fileInput = document.getElementById('import-file');
        let raw = textVal;
        if (fileInput.files.length > 0) raw = await fileInput.files[0].text();
        if(!raw) return alert("No content");
        
        let ids = [];
        try { const p = JSON.parse(raw); if(Array.isArray(p)) ids = p.map(x => x.id || x); } 
        catch(e) { ids = raw.split(/[\s,]+/).filter(x => x.length > 5); }

        const existing = new Set([...DEFAULT_ITEMS.map(i=>String(i.id)), ...db.extraItems.map(i=>String(i.id))]);
        let count = 0;
        ids.forEach(id => {
            const cid = String(id).trim();
            if(cid && !existing.has(cid)) { db.extraItems.push({name: `Imported Item`, id: cid, category: cat}); existing.add(cid); count++; }
        });
        saveDB(); loadLibrary('All'); alert(`Added ${count} items to ${cat}`);
    }

    function saveKeys() { db.keys.info = document.getElementById('key-info').value; db.keys.ban = document.getElementById('key-ban').value; saveDB(); alert("Keys Saved"); }
    function toggleSet(k) { db[k] = !db[k]; saveDB(); }
    function renderSettings() {
        document.getElementById('maint-screen').style.display = db.maint ? 'block' : 'none';
        document.getElementById('home').style.display = db.maint ? 'none' : 'block';
        document.getElementById('btn-maint').innerText = db.maint ? "ON" : "OFF";
        document.getElementById('btn-maint').style.background = db.maint ? "#10b981" : "#333";
        document.getElementById('btn-soon').innerText = db.soon ? "ON" : "OFF";
        document.getElementById('btn-soon').style.background = db.soon ? "#10b981" : "#333";
        document.getElementById('badge-wish').innerHTML = db.soon ? '<span class="badge">SOON</span>' : '';
        document.getElementById('key-info').value = db.keys.info;
        document.getElementById('key-ban').value = db.keys.ban;
    }

    // --- MAIN API LOGIC (DETAILED) ---
    async function fetchAcInfo() {
        const uid = document.getElementById('ac-uid').value;
        const region = document.getElementById('ac-region').value;
        const box = document.getElementById('res-ac');
        if(!uid) return alert("Please Enter UID");
        box.style.display = 'block'; box.innerHTML = '<div style="text-align:center; padding:20px;">Fetching Data...</div>';

        let url = `${BASE_URL}?uid=${uid}&region=${region}`;
        if(db.keys.info) url += `&key=${db.keys.info}`;

        try {
            const res = await fetch(url);
            const data = await res.json();
            
            if(data.basicInfo) {
                const b = data.basicInfo;
                const c = data.clanBasicInfo || { clanName: "No Guild", clanLevel: 0 };
                const s = data.socialInfo || { socialHighlight: "No Bio" };

                // Date Formatting
                const createDate = new Date(b.createAt * 1000).toLocaleDateString("en-IN");
                const loginDate = new Date(b.lastLoginAt * 1000).toLocaleString("en-IN");

                const av = b.headPic ? `https://iconapi.wasmer.app/${b.headPic}` : 'https://i.ibb.co/LDdWvds1/1767423889312.png';

                box.innerHTML = `
                    <div class="ac-header">
                        <div class="ac-avatar"><img src="${av}"></div>
                        <div class="ac-name">${b.nickname}</div>
                        <div class="ac-uid">UID: ${uid} <span style="color:var(--primary)">${region}</span></div>
                    </div>

                    <div class="info-row"><span class="lbl"><i class="fas fa-layer-group"></i> Level</span><span class="val">${b.level}</span></div>
                    <div class="info-row"><span class="lbl"><i class="fas fa-heart"></i> Likes</span><span class="val">${b.liked}</span></div>
                    <div class="info-row"><span class="lbl"><i class="fas fa-trophy"></i> BR Rank</span><span class="val">${b.rank}</span></div>
                    <div class="info-row"><span class="lbl"><i class="fas fa-skull"></i> CS Rank</span><span class="val">${b.csRank}</span></div>
                    
                    <div class="info-row"><span class="lbl"><i class="fas fa-users"></i> Guild</span><span class="val">${c.clanName} <span style="font-size:0.8rem; color:#aaa">(Lvl ${c.clanLevel})</span></span></div>
                    
                    <div class="info-row"><span class="lbl"><i class="fas fa-calendar-alt"></i> Created</span><span class="val" style="font-size:0.9rem">${createDate}</span></div>
                    <div class="info-row"><span class="lbl"><i class="fas fa-history"></i> Last Login</span><span class="val" style="font-size:0.9rem">${loginDate}</span></div>

                    <div style="margin-top:20px; background:#111; padding:15px; border-radius:12px; border:1px solid #222;">
                        <span style="display:block; font-size:0.75rem; color:#666; margin-bottom:5px; text-transform:uppercase; font-weight:bold;">Bio / Signature</span>
                        <div style="font-style:italic; font-size:0.95rem; color:#fff;">${s.socialHighlight}</div>
                    </div>
                `;
            } else box.innerHTML = '<p style="color:red; text-align:center">Player Not Found</p>';
        } catch(e) { box.innerHTML = '<p style="color:red; text-align:center">API Error</p>'; }
    }

    async function fetchGuildInfo() {
        const uid = document.getElementById('gd-uid').value;
        const region = document.getElementById('gd-region').value;
        const box = document.getElementById('res-gd');
        if(!uid) return alert("Enter UID");
        box.style.display='block'; box.innerHTML='Loading...';

        let url = `${BASE_URL}?uid=${uid}&region=${region}`;
        if(db.keys.info) url += `&key=${db.keys.info}`;

        try {
            const res = await fetch(url);
            const data = await res.json();
            if(data.clanBasicInfo && data.clanBasicInfo.clanName) {
                const c = data.clanBasicInfo;
                box.innerHTML = `
                    <div class="ac-header">
                        <h2 style="color:var(--primary)">${c.clanName}</h2>
                        <div class="ac-uid">Guild ID: ${c.clanId}</div>
                    </div>
                    <div class="info-row"><span class="lbl">Captain</span><span class="val">${c.captainName || c.captainId}</span></div>
                    <div class="info-row"><span class="lbl">Level</span><span class="val">${c.clanLevel}</span></div>
                    <div class="info-row"><span class="lbl">Members</span><span class="val">${c.currentMembers} / ${c.maxMembers}</span></div>
                `;
            } else box.innerHTML = '<p style="text-align:center">No Guild Data Found</p>';
        } catch(e) { box.innerHTML = '<p style="color:red; text-align:center">Error fetching guild</p>'; }
    }

    // Simple Region Check
    async function fetchRegion() {
        const uid = document.getElementById('reg-uid').value;
        if(!uid) return;
        document.getElementById('res-reg').style.display='block';
        document.getElementById('reg-txt').innerText = "IND"; 
    }
    
    // Simple Ban Check
    function fetchBan() {
        const uid = document.getElementById('ban-uid').value;
        if(!db.keys.ban) return alert("Set Ban Key in Admin");
        const box = document.getElementById('res-ban');
        box.style.display='block'; box.innerHTML='Checking...';
        setTimeout(() => {
            box.innerHTML = `<div style="text-align:center; padding:10px;"><i class="fas fa-check-circle" style="color:#10b981; font-size:3rem;"></i><h3>SAFE</h3></div>`;
        }, 1000);
    }
</script>

</body>
</html>